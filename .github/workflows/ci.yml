on: push
jobs:
  curl:
    runs-on: ubuntu-latest
    steps:
    - name: List files
      run: ls
    - run: export time=$(($(date +%s%N)/1000))
    - run: echo $time
    - name: Use curl download
      uses: wei/curl@master
      with:
        args: curl https://ibus.nsysu.edu.tw/API/RoutePath.aspx\?$time\&T=SC -o tmp.json
    - run: rm -f bus_info_data_zh.json
    - name: Use JD
      uses: r26d/jq-action@master
      with:
        cmd: jq -n env
    - name: merge json
      run: jq -s '.[0] + .[1]' bus_zh.json tmp.json >> bus_info_data_zh.json
      working-directory: ./
    - run: rm -f tmp.json
    - name: export json
      run: echo bus_info_data_zh.json